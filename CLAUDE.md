# 体重管理アプリ要件整理

## 基本要件ヒアリング項目

### 1. ターゲットユーザー
- [x] **年齢層**: 自分用
- [x] **利用形態**: 個人利用

### 2. プラットフォーム
- [x] **対象プラットフォーム**: Webアプリ
- [x] **クロスプラットフォーム対応**: 不要

### 3. 主要機能
- [x] **体重記録**: 必要
- [x] **目標設定**: 必要
- [x] **グラフ表示**: 必要
- [x] **BMI記録**: 必要
- [x] **筋肉量記録**: 必要

### 4. データ管理
- [x] **データ保存**: Vercel KVに保存
- [x] **データバックアップ**: 不要
- [x] **他アプリとの連携**: 不要

## 詳細要件ヒアリング項目

### 5. 技術スタック
- [x] **フロントエンド**: Next.js 14 (App Router) + TypeScript推奨
- [x] **バックエンド**: Next.js API Routes + Vercel KV
- [x] **UIライブラリ**: shadcn/ui + Tailwind CSS推奨（代替: Chakra UI）

### 6. 記録データの詳細
- [x] **体重の精度**: 小数点第一位まで（例: 70.5kg）
- [x] **筋肉量の単位**: kg
- [x] **記録頻度**: 毎日
- [x] **記録時刻**: 不規則（時刻指定なし）

### 7. 目標設定
- [x] **目標の種類**: 目標体重、期限設定、月間・週間減量目標、BMI目標
- [x] **目標達成表示**: プログレスバー、達成予想日、残り体重、週間/月間ペース、モチベーションメッセージ

### 8. グラフ表示
- [x] **表示期間**: 1週間、1ヶ月、半年、最大1年
- [x] **グラフの種類**: 体重推移、BMI推移、筋肉量推移、目標との比較

# 体重管理アプリ要件定義書

## 概要
個人用の体重管理WebアプリケーションをNext.js + Vercel KVで構築する。

## 基本要件

### 1. ターゲットユーザー
- **対象**: 個人用（自分専用）
- **利用形態**: 単一ユーザー

### 2. プラットフォーム・技術スタック
- **フロントエンド**: Next.js 14 (App Router) + TypeScript
- **バックエンド**: Next.js API Routes + Vercel KV
- **UIライブラリ**: shadcn/ui + Tailwind CSS
- **グラフライブラリ**: Recharts
- **開発環境**: Docker
- **本番環境**: Vercel

### 3. 認証・セキュリティ
- **基本方針**: Vercelでアクセス制限実施、不可能であればログイン機能を実装
- **アクセス制御**: 個人用のため第三者アクセス防止が必要

## 主要機能

### 4. データ記録機能
- **体重記録**: 小数点第一位まで（例: 70.5kg）
- **筋肉量記録**: kg単位
- **体脂肪率記録**: %単位
- **身長設定**: 変更可能
- **記録頻度**: 毎日（時刻指定なし）

### 5. データ入力UI
- **入力方式**: 数値入力フィールド
- **日付選択**: カレンダーピッカー
- **モバイル対応**: レスポンシブ対応必須
- **ダークモード**: 不要

### 6. 初期設定
アプリ初回起動時に設定する項目：
- 身長
- 初期体重
- 目標体重
- 目標期日

### 7. 目標設定・達成状況表示
- **目標項目**: 目標体重、期限設定、月間・週間減量目標、BMI目標
- **達成状況表示**:
  - プログレスバー（目標達成率の視覚表示）
  - 達成予想日（現在ペースでの予想達成日）
  - 残り体重表示（目標まであと何kg）
  - 週間/月間ペース表示

### 8. グラフ・可視化機能
- **表示期間**: 1週間、1ヶ月、半年、最大1年
- **グラフ種類**:
  - 体重推移
  - BMI推移
  - 筋肉量推移
  - 目標との比較
- **スタイル**: デフォルト設定で開始、後で調整

## データ管理

### 9. データ保存
- **保存先**: Vercel KV
- **バックアップ**: 不要
- **エクスポート**: 不要
- **外部連携**: 不要

## 将来拡張予定

### 10. 拡張機能
- **AI機能**: モチベーション表示（生成AI活用）
- **モチベーション管理**: 追加機能として検討

## 非機能要件

### 11. 対応環境
- **ブラウザ**: モダンブラウザ対応
- **デバイス**: PC・スマートフォン（レスポンシブ）

### 12. パフォーマンス
- **読み込み速度**: Vercel最適化活用
- **データ同期**: リアルタイム不要

### 13. 不要機能
- カロリー管理
- 運動記録
- 食事記録
- リマインダー機能
- メモ機能
- データエクスポート
- 他アプリ連携

## 開発優先度
1. **Phase 1**: 基本的なデータ記録・表示機能
2. **Phase 2**: グラフ表示・目標設定機能
3. **Phase 3**: 認証機能（必要に応じて）
4. **Future**: AI機能・モチベーション管理

## テスト・動作確認方針
- **テスト実行環境**: Docker環境での実行
- **テストツール**: MCP Playwright（ブラウザ自動化テスト）
- **確認項目**: 各phaseの機能実装後に動作確認とE2Eテストを実施
- **テスト範囲**: UI操作、データ保存・取得、レスポンシブ対応、エラーハンドリング

## 完了
✅ 要件定義完了

## 開発フェーズ詳細

### Phase 0: Docker環境構築
**目標**: 開発環境の構築と標準化

#### 0-1. Docker基本設定
- [x] Dockerfile作成（Node.js 20 LTS）
- [x] docker-compose.yml作成
- [x] .dockerignore設定
- [x] マルチステージビルド設定

#### 0-2. 開発環境設定
- [x] ホットリロード設定
- [x] ボリュームマウント設定
- [x] 環境変数設定（.env.local）
- [x] ポート設定（3000番）

#### 0-3. Vercel KV連携設定
- [x] Vercel CLI設定
- [x] KV接続用環境変数設定
- [x] ローカル開発用モック設定

### Phase 1: 基本的なデータ記録・表示機能
**目標**: 体重データの記録と基本的な表示機能を実装

#### 1-1. プロジェクト初期設定
- [x] Next.js 14 (App Router) プロジェクト作成
- [x] TypeScript設定
- [x] Tailwind CSS設定
- [x] shadcn/ui導入
- [x] Vercel KV接続設定
- [x] 基本的なレイアウト構成
- [x] ESLint/Prettier設定

#### 1-2. データモデル設計
- [x] 体重記録データスキーマ定義
- [x] ユーザー設定データスキーマ定義
- [x] Vercel KV用のデータ構造設計
- [x] TypeScript型定義

#### 1-3. 初期設定画面
- [x] 身長入力フォーム
- [x] 初期体重入力フォーム
- [x] 目標体重入力フォーム
- [x] 目標期日設定
- [x] データ保存処理
- [x] 初回起動判定ロジック

#### 1-4. データ記録機能
- [x] 体重入力フォーム作成
- [x] 筋肉量入力フォーム作成
- [x] 体脂肪率入力フォーム作成
- [x] 日付選択（カレンダーピッカー）
- [x] データ保存API実装
- [x] 入力バリデーション
- [x] 重複登録防止

#### 1-5. データ表示機能
- [x] 記録一覧表示
- [x] 最新データ表示
- [x] BMI自動計算・表示
- [x] 編集・削除機能
- [x] ページネーション

#### 1-6. Phase 1 動作確認・テスト
- [ ] Docker環境でのアプリケーション起動確認
- [ ] MCP Playwrightによる初期設定画面テスト
- [ ] MCP Playwrightによる体重記録機能テスト
- [ ] MCP Playwrightによる記録一覧表示テスト
- [ ] レスポンシブ対応確認（モバイル・デスクトップ）
- [ ] データ保存・取得の動作確認
- [ ] エラーハンドリングの動作確認

### Phase 2: グラフ表示・目標設定機能
**目標**: データの可視化と目標管理機能を実装

#### 2-1. グラフ機能基盤
- [ ] Recharts導入
- [ ] グラフコンポーネント基本設計
- [ ] データフォーマット処理
- [ ] グラフ共通スタイル定義

#### 2-2. 各種グラフ実装
- [ ] 体重推移グラフ
- [ ] BMI推移グラフ
- [ ] 筋肉量推移グラフ
- [ ] 体脂肪率推移グラフ
- [ ] 期間切り替え（1週間/1ヶ月/半年/1年）
- [ ] グラフズーム機能

#### 2-3. 目標管理機能
- [ ] 目標設定画面
- [ ] 週間/月間減量目標設定
- [ ] BMI目標設定
- [ ] 目標データ保存処理
- [ ] 目標変更履歴

#### 2-4. 達成状況表示
- [ ] プログレスバー実装
- [ ] 目標達成予想日計算・表示
- [ ] 残り体重表示
- [ ] 週間/月間ペース計算・表示
- [ ] 目標との比較グラフ
- [ ] 達成率表示

#### 2-5. レスポンシブ対応
- [ ] モバイル用UI調整
- [ ] タッチ操作最適化
- [ ] グラフのモバイル表示調整
- [ ] スワイプ操作対応

#### 2-6. Phase 2 動作確認・テスト
- [ ] Docker環境でのグラフ表示確認
- [ ] MCP Playwrightによるグラフ機能テスト
- [ ] MCP Playwrightによる目標設定テスト
- [ ] MCP Playwrightによる達成状況表示テスト
- [ ] 期間切り替え機能の動作確認
- [ ] レスポンシブ対応確認（グラフ表示）
- [ ] データ可視化の正確性確認

### Phase 3: 認証機能（必要に応じて）
**目標**: アクセス制限とセキュリティ実装

#### 3-1. 認証方式検討
- [ ] Vercelのアクセス制限機能調査
- [ ] 代替認証方式の選定
- [ ] セキュリティ要件定義

#### 3-2. 認証実装（Vercel制限不可の場合）
- [ ] ログイン画面作成
- [ ] 認証処理実装
- [ ] セッション管理
- [ ] アクセス制御
- [ ] パスワードリセット機能

#### 3-3. Phase 3 動作確認・テスト
- [ ] Docker環境での認証機能確認
- [ ] MCP Playwrightによるログイン機能テスト
- [ ] MCP Playwrightによるアクセス制御テスト
- [ ] セッション管理の動作確認
- [ ] セキュリティ要件の確認
- [ ] 不正アクセス防止の確認

### Phase 4: 本番環境構築
**目標**: Vercelへのデプロイと運用設定

#### 4-1. Vercelプロジェクト設定
- [ ] Vercelプロジェクト作成
- [ ] 環境変数設定
- [ ] ドメイン設定（必要に応じて）

#### 4-2. CI/CD設定
- [ ] GitHub連携
- [ ] 自動デプロイ設定
- [ ] プレビューデプロイ設定

#### 4-3. 監視・ログ設定
- [ ] エラー監視
- [ ] パフォーマンス監視
- [ ] アクセスログ設定

#### 4-4. Phase 4 動作確認・テスト
- [ ] Vercel本番環境での動作確認
- [ ] MCP Playwrightによる本番環境E2Eテスト
- [ ] パフォーマンステスト実行
- [ ] セキュリティテスト実行
- [ ] 監視・ログ機能の動作確認
- [ ] デプロイプロセスの確認

### Future: AI機能・モチベーション管理
**目標**: ユーザーエンゲージメント向上機能

#### F-1. AI機能
- [ ] OpenAI API連携
- [ ] モチベーションメッセージ生成
- [ ] アドバイス機能
- [ ] 体重予測機能

#### F-2. モチベーション管理
- [ ] 連続記録日数表示
- [ ] 達成バッジ機能
- [ ] カスタムメッセージ設定
- [ ] 週次/月次レポート生成